{"ast":null,"code":"export default class AuthenticationService {\n  static isAuthenticated() {\n    const token = localStorage.getItem(\"token\");\n    // la double négation permet de convertir le token en boolean\n    return !!token;\n  }\n  static login(username, password) {\n    return fetch(\"http://localhost:3001/api/login\", {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\"\n      },\n      body: JSON.stringify({\n        username,\n        password\n      })\n    }).then(response => response.json()).then(response => {\n      this.saveToken(response.token);\n      return this.isAuthenticated();\n    }).catch(error => {\n      this.handleError(error);\n      return false;\n    });\n  }\n  static saveToken(token) {\n    // c'est comme le cookie de la page de navigation qui n'a pas d'expiration\n    // contrairement au sessionStorage qui est nettoyé quand le navigateur prend fin\n    if (token) localStorage.setItem(\"token\", token);\n  }\n  static logout() {\n    localStorage.removeItem(\"token\");\n  }\n  static handleError(error) {\n    console.log(error);\n    window.location = \"/server/error\";\n  }\n}","map":{"version":3,"names":["AuthenticationService","isAuthenticated","token","localStorage","getItem","login","username","password","fetch","method","headers","body","JSON","stringify","then","response","json","saveToken","catch","error","handleError","setItem","logout","removeItem","console","log","window","location"],"sources":["C:/Users/yuedo/OneDrive/Bureau/JS/React/pokedex/client/src/services/authentication-service.ts"],"sourcesContent":["export default class AuthenticationService {\r\n  static isAuthenticated(): boolean {\r\n    const token: string | null = localStorage.getItem(\"token\");\r\n    // la double négation permet de convertir le token en boolean\r\n    return !!token;\r\n  }\r\n\r\n  static login(username: string, password: string): Promise<boolean> {\r\n    return fetch(\"http://localhost:3001/api/login\", {\r\n      method: \"POST\",\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n      },\r\n      body: JSON.stringify({ username, password }),\r\n    })\r\n      .then((response) => response.json())\r\n      .then((response) => {\r\n        this.saveToken(response.token);\r\n        return this.isAuthenticated();\r\n      })\r\n      .catch((error) => {\r\n        this.handleError(error);\r\n        return false;\r\n      });\r\n  }\r\n\r\n  static saveToken(token: string): void {\r\n    // c'est comme le cookie de la page de navigation qui n'a pas d'expiration\r\n    // contrairement au sessionStorage qui est nettoyé quand le navigateur prend fin\r\n    if (token) localStorage.setItem(\"token\", token);\r\n  }\r\n\r\n  static logout(): void {\r\n    localStorage.removeItem(\"token\");\r\n  }\r\n\r\n  static handleError(error: Error): void {\r\n    console.log(error);\r\n    window.location = \"/server/error\" as unknown as Location;\r\n  }\r\n}\r\n"],"mappings":"AAAA,eAAe,MAAMA,qBAAqB,CAAC;EACzC,OAAOC,eAAeA,CAAA,EAAY;IAChC,MAAMC,KAAoB,GAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC;IAC1D;IACA,OAAO,CAAC,CAACF,KAAK;EAChB;EAEA,OAAOG,KAAKA,CAACC,QAAgB,EAAEC,QAAgB,EAAoB;IACjE,OAAOC,KAAK,CAAC,iCAAiC,EAAE;MAC9CC,MAAM,EAAE,MAAM;MACdC,OAAO,EAAE;QACP,cAAc,EAAE;MAClB,CAAC;MACDC,IAAI,EAAEC,IAAI,CAACC,SAAS,CAAC;QAAEP,QAAQ;QAAEC;MAAS,CAAC;IAC7C,CAAC,CAAC,CACCO,IAAI,CAAEC,QAAQ,IAAKA,QAAQ,CAACC,IAAI,CAAC,CAAC,CAAC,CACnCF,IAAI,CAAEC,QAAQ,IAAK;MAClB,IAAI,CAACE,SAAS,CAACF,QAAQ,CAACb,KAAK,CAAC;MAC9B,OAAO,IAAI,CAACD,eAAe,CAAC,CAAC;IAC/B,CAAC,CAAC,CACDiB,KAAK,CAAEC,KAAK,IAAK;MAChB,IAAI,CAACC,WAAW,CAACD,KAAK,CAAC;MACvB,OAAO,KAAK;IACd,CAAC,CAAC;EACN;EAEA,OAAOF,SAASA,CAACf,KAAa,EAAQ;IACpC;IACA;IACA,IAAIA,KAAK,EAAEC,YAAY,CAACkB,OAAO,CAAC,OAAO,EAAEnB,KAAK,CAAC;EACjD;EAEA,OAAOoB,MAAMA,CAAA,EAAS;IACpBnB,YAAY,CAACoB,UAAU,CAAC,OAAO,CAAC;EAClC;EAEA,OAAOH,WAAWA,CAACD,KAAY,EAAQ;IACrCK,OAAO,CAACC,GAAG,CAACN,KAAK,CAAC;IAClBO,MAAM,CAACC,QAAQ,GAAG,eAAsC;EAC1D;AACF"},"metadata":{},"sourceType":"module","externalDependencies":[]}